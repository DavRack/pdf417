import{_ as fe}from"../chunks/preload-helper.a4192956.js";import{r as K,s as ue,n as Q,b as X,f as ve}from"../chunks/scheduler.b95eede2.js";import{d as pe,S as me,i as ge,s as j,m as T,g as D,c as M,n as $,h as E,j as S,f as _,l as v,a as P,z as be,e as Z,y as ee,k as ye,x as I,A as te,B as ie,o as z,C as ae}from"../chunks/index.540650a8.js";let ne,we=(async()=>{function H(l){return(l==null?void 0:l.length)!==void 0?l:Array.from(l)}function B(l,a){l.d(1),a.delete(l.key)}function F(l,a,e,d,c,r,t,n,i,f,y,w){let b=l.length,g=r.length,p=b;const m={};for(;p--;)m[l[p].key]=p;const k=[],V=new Map,A=new Map,O=[];for(p=g;p--;){const s=w(c,r,p),x=e(s);let C=t.get(x);C?d&&O.push(()=>C.p(s,a)):(C=f(x,s),C.c()),V.set(x,k[p]=C),x in m&&A.set(x,Math.abs(p-m[x]))}const u=new Set,o=new Set;function h(s){pe(s,1),s.m(n,y),t.set(s.key,s),y=s.first,g--}for(;b&&g;){const s=k[g-1],x=l[b-1],C=s.key,N=x.key;s===x?(y=s.first,b--,g--):V.has(N)?!t.has(C)||u.has(C)?h(s):o.has(N)?b--:A.get(C)>A.get(N)?(o.add(C),h(s)):(u.add(N),b--):(i(x,t),b--)}for(;b--;){const s=l[b];V.has(s.key)||i(s,t)}for(;g;)h(k[g-1]);return K(O),k}function G(l,a,e){const d=l.slice();return d[23]=a[e],d}function L(l,a,e){const d=l.slice();return d[20]=a[e],d}function le(l){let a=[],e=new Map,d,c=H(l[4]);const r=t=>t[23].field;for(let t=0;t<c.length;t+=1){let n=G(l,c,t),i=r(n);e.set(i,a[t]=R(i,n))}return{c(){for(let t=0;t<a.length;t+=1)a[t].c();d=Z()},l(t){for(let n=0;n<a.length;n+=1)a[n].l(t);d=Z()},m(t,n){for(let i=0;i<a.length;i+=1)a[i]&&a[i].m(t,n);P(t,d,n)},p(t,n){n&16&&(c=H(t[4]),a=F(a,n,r,1,t,c,e,d.parentNode,B,R,d,G))},d(t){t&&_(d);for(let n=0;n<a.length;n+=1)a[n].d(t)}}}function oe(l){let a,e,d="Cambiar c\xE1mara",c,r,t=[],n=new Map,i,f,y,w,b="Video stream not available.",g,p,m,k,V,A=H(l[5]);const O=u=>u[20].deviceId;for(let u=0;u<A.length;u+=1){let o=L(l,A,u),h=O(o);n.set(h,t[u]=U(h,o))}return{c(){a=D("div"),e=D("div"),e.textContent=d,c=j(),r=D("select");for(let u=0;u<t.length;u+=1)t[u].c();i=j(),f=D("div"),y=D("div"),w=D("video"),w.textContent=b,g=j(),p=D("div"),m=D("div"),this.h()},l(u){a=E(u,"DIV",{style:!0});var o=S(a);e=E(o,"DIV",{"data-svelte-h":!0}),ee(e)!=="svelte-9wokc4"&&(e.textContent=d),c=M(o),r=E(o,"SELECT",{placeholder:!0});var h=S(r);for(let W=0;W<t.length;W+=1)t[W].l(h);h.forEach(_),o.forEach(_),i=M(u),f=E(u,"DIV",{style:!0});var s=S(f);y=E(s,"DIV",{style:!0});var x=S(y);w=E(x,"VIDEO",{style:!0,"data-svelte-h":!0}),ee(w)!=="svelte-z17c9j"&&(w.textContent=b),g=M(x),p=E(x,"DIV",{style:!0});var C=S(p);m=E(C,"DIV",{style:!0});var N=S(m);N.forEach(_),C.forEach(_),x.forEach(_),s.forEach(_),this.h()},h(){ye(r,"placeholder","Cambiar c\xE1mara"),l[0]===void 0&&ve(()=>l[7].call(r)),v(a,"background-color","white"),v(w,"object-fit","initial"),v(w,"width","inherit"),v(w,"height","inherit"),v(w,"max-height","inherit"),v(w,"position","relative"),v(m,"margin","auto"),v(m,"border-width","0.2em"),v(m,"border-radius","1em"),v(m,"border-color","white"),v(m,"border-style","solid"),v(m,"width",Y+"%"),v(m,"aspect-ratio",J),v(p,"position","absolute"),v(p,"top","0px"),v(p,"width","100%"),v(p,"height","100%"),v(p,"display","flex"),v(p,"flex-direction","column"),v(p,"justify-content","center"),v(y,"max-width","100svw"),v(y,"max-height","80svh"),v(y,"position","relative"),v(f,"display","flex"),v(f,"flex-direction","row"),v(f,"justify-content","center"),v(f,"max-width","100svw"),v(f,"height","90svh")},m(u,o){P(u,a,o),I(a,e),I(a,c),I(a,r);for(let h=0;h<t.length;h+=1)t[h]&&t[h].m(r,null);te(r,l[0],!0),P(u,i,o),P(u,f,o),I(f,y),I(y,w),l[8](w),I(y,g),I(y,p),I(p,m),k||(V=[ie(r,"change",l[7]),ie(w,"canplay",ce)],k=!0)},p(u,o){o&32&&(A=H(u[5]),t=F(t,o,O,1,u,A,n,r,B,U,null,L)),o&33&&te(r,u[0])},d(u){u&&(_(a),_(i),_(f));for(let o=0;o<t.length;o+=1)t[o].d();l[8](null),k=!1,K(V)}}}function R(l,a){let e,d,c=a[23].label+"",r,t,n,i,f=a[23].value+"",y,w;return{key:l,first:null,c(){e=D("div"),d=D("b"),r=T(c),t=T(":"),n=j(),i=D("span"),y=T(f),w=j(),this.h()},l(b){e=E(b,"DIV",{});var g=S(e);d=E(g,"B",{});var p=S(d);r=$(p,c),t=$(p,":"),p.forEach(_),n=M(g),i=E(g,"SPAN",{});var m=S(i);y=$(m,f),m.forEach(_),w=M(g),g.forEach(_),this.h()},h(){this.first=e},m(b,g){P(b,e,g),I(e,d),I(d,r),I(d,t),I(e,n),I(e,i),I(i,y),I(e,w)},p(b,g){a=b,g&16&&c!==(c=a[23].label+"")&&z(r,c),g&16&&f!==(f=a[23].value+"")&&z(y,f)},d(b){b&&_(e)}}}function U(l,a){let e,d=a[20].label+"",c,r,t;return{key:l,first:null,c(){e=D("option"),c=T(d),r=j(),this.h()},l(n){e=E(n,"OPTION",{});var i=S(e);c=$(i,d),r=M(i),i.forEach(_),this.h()},h(){e.__value=t=a[20],ae(e,e.__value),this.first=e},m(n,i){P(n,e,i),I(e,c),I(e,r)},p(n,i){a=n,i&32&&d!==(d=a[20].label+"")&&z(c,d),i&32&&t!==(t=a[20])&&(e.__value=t,ae(e,e.__value))},d(n){n&&_(e)}}}function re(l){let a,e,d,c;function r(i,f){return i[3]?le:oe}let t=r(l),n=t(l);return{c(){n.c(),a=j(),e=T(q),d=j(),c=D("canvas"),this.h()},l(i){n.l(i),a=M(i),e=$(i,q),d=M(i),c=E(i,"CANVAS",{style:!0}),S(c).forEach(_),this.h()},h(){v(c,"display","none")},m(i,f){n.m(i,f),P(i,a,f),P(i,e,f),P(i,d,f),P(i,c,f),l[9](c)},p(i,[f]){t===(t=r(i))&&n?n.p(i,f):(n.d(1),n=t(i),n&&(n.c(),n.m(a.parentNode,a)))},i:Q,o:Q,d(i){i&&(_(a),_(e),_(d),_(c)),n.d(i),l[9](null)}}}const J=5,Y=90;let se=3840,de=2160,q="";const ce=()=>{};function he(l,a,e){let{decodesPerSecond:d=1}=a,c,r,t=!1,n,i=[{label:"Primer N\xF3mbre",value:"",field:"firstName",position:[104,127]},{label:"Segundo nombre",value:"",field:"middleName",position:[127,150]},{label:"Primer Apellido",value:"",field:"lastName",position:[58,81]},{label:"Segundo Apellido",value:"",field:"secondLastName",position:[81,104]},{label:"N\xFAmero documento",value:"",field:"documentNumber",position:[48,58]},{label:"Genero",value:"",field:"gender",position:[151,152]},{label:"D\xEDa nacimiento",value:"",field:"birthdayDay",position:[158,160]},{label:"Mes nacimiento",value:"",field:"birthdayMonth",position:[156,158]},{label:"A\xF1o nacimiento",value:"",field:"birthdayYear",position:[152,156]},{label:"Tipo de sangre",value:"",field:"bloodType",position:[166,168]},{label:"C\xF3digo de departamento",value:"",field:"departmentCode",position:[160,162]},{label:"C\xF3digo municipio",value:"",field:"municipalityCode",position:[162,165]},{label:"C\xF3digo afis",value:"",field:"afisCode",position:[0,24]},{label:"Finger Card",value:"",field:"fingerCard",position:[40,48]}];const f={advanced:[{autoGainControl:!1,noiseSuppression:!1,width:se,height:de}]};let y=setInterval(g,1e3/d);async function w(o,h){h.deviceId||(h=(await navigator.mediaDevices.enumerateDevices()).filter(s=>s.kind==="videoinput").find(s=>s.label.includes("back")||s.label.includes("trasera")),e(0,m=h)),navigator.mediaDevices.getUserMedia({audio:!1,video:{...o,deviceId:h==null?void 0:h.deviceId}}).then(s=>{e(2,r.srcObject=s,r),r.play()})}function b(){let o=Y/100,h=r.videoWidth*o,s=h/J,x=r.videoHeight/2-s/2,C=(1-o)/2*r.videoWidth;e(1,c.width=h,c),e(1,c.height=s,c);let N=c.getContext("2d");if(!N)throw Error("Cant get canvas context");return N.fillStyle="#AAA",N.fillRect(0,0,h,s),N.drawImage(r,C,x,h,s,0,0,h,s),N.getImageData(0,0,r.videoWidth,r.videoHeight)}async function g(){V();let o=await fe(()=>import("../chunks/rxing_wasm.d98712d3.js").then(async s=>(await s.__tla,s)),[],import.meta.url),h=new o.DecodeHintDictionary;h.set_hint(o.DecodeHintTypes.PossibleFormats,"Pdf417");try{let s=b();const x=o.convert_js_image_to_luma(new Uint8Array(s.data));let C=o.decode_barcode_with_hints(x,r.videoWidth,r.videoHeight,h).text();n=C,clearInterval(y),e(4,i=p(C)),e(3,t=!0)}catch{n="no se ha encontrado un c\xF3digo, sigue intentando",e(3,t=!1)}}function p(o){for(let h=0;h<i.length;h++){let s=i[h],x=o.slice(...s.position).split("").filter(C=>C.codePointAt(0)!==65533).join("").replace(/^0+/,"");s.value=x}return i}p("");let m={deviceId:"",groupId:"",kind:"videoinput",label:"",toJSON:()=>{}},k=[];async function V(){let o=(await navigator.mediaDevices.enumerateDevices()).filter(h=>h.kind==="videoinput");e(5,k=o)}function A(){m=be(this),e(0,m),e(5,k)}function O(o){X[o?"unshift":"push"](()=>{r=o,e(2,r)})}function u(o){X[o?"unshift":"push"](()=>{c=o,e(1,c)})}return l.$$set=o=>{"decodesPerSecond"in o&&e(6,d=o.decodesPerSecond)},l.$$.update=()=>{l.$$.dirty&1&&w(f,m),l.$$.dirty&1&&console.log(m)},[m,c,r,t,i,k,d,A,O,u]}ne=class extends me{constructor(l){super(),ge(this,l,he,re,ue,{decodesPerSecond:6})}}})();export{we as __tla,ne as component};
